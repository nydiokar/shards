# Pipelight Pipeline: Swab the Deck with Free-Tier AI
## Scheduled Hecke-Maass Sharding + AI Analysis

triggers:
  - name: daily_swab
    cron: "0 2 * * *"  # 2 AM daily
  - name: on_push
    branch: main

pipelines:
  swab_deck:
    steps:
      - name: inventory
        commands:
          - ./swab_the_deck.sh
      
      - name: analyze_with_gemini
        commands:
          - nix develop .#gemini-cli -c gemini-analyze-shards
      
      - name: analyze_with_claude
        commands:
          - nix develop .#claude-cli -c claude-analyze-shards
      
      - name: analyze_with_gpt
        commands:
          - nix develop .#openai-cli -c gpt-analyze-shards
      
      - name: analyze_with_llama
        commands:
          - nix develop .#ollama -c ollama-analyze-shards
      
      - name: consensus
        commands:
          - python3 ai_consensus.py
      
      - name: commit_results
        commands:
          - git add HECKE_MAASS_MANIFEST.json AI_ANALYSIS.json
          - git commit -m "chore: swab deck $(date +%Y-%m-%d)"
          - git push

options:
  detach: false
  log_level: info
